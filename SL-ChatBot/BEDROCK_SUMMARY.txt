Bedrock 통합 요약 (KO)
- 챗봇을 Ollama에서 AWS Bedrock(Claude 3.5 Sonnet v2) + Titan Embeddings로 전환 완료.
- 리전은 도쿄(ap-northeast-1), LLM은 교차 리전 프로필 ID(us.anthropic.claude-3-5-sonnet-20241022-v2:0) 사용.
- RAG는 ChromaDB + Titan Embeddings V2(amazon.titan-embed-text-v2:0)로 재색인.
- 모든 Docker 서비스 정상 동작, 뉴스 질의/전략 설명/용어 설명 테스트 통과.
- 전체 설치·설정·트러블슈팅 문서화 완료: SL-ChatBot/BEDROCK_SETUP.md.

핵심 변경 파일
- .env: AWS_REGION, AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY, BEDROCK_MODEL_ID, BEDROCK_EMBEDDING_MODEL_ID
  예) AWS_REGION=ap-northeast-1, BEDROCK_MODEL_ID=us.anthropic.claude-3-5-sonnet-20241022-v2:0
  주의: 실제 키는 안전하게 보관.
- docker-compose.yml: LLM_PROVIDER=bedrock, Bedrock 관련 env 전달(모델 ID는 캐싱 이슈로 하드코딩).
- SL-ChatBot/api/requirements.txt: boto3, botocore 추가.
- SL-ChatBot/chatbot/config.yaml: llm.provider/model, rag.embedding_model_id 설정.
- SL-ChatBot/chatbot/src/handler.py: Bedrock Runtime 클라이언트 초기화.
- SL-ChatBot/chatbot/src/rag_retriever.py: Titan 임베딩 함수(Chroma 인터페이스 호환) 구현.
- SL-ChatBot/BEDROCK_SETUP.md: 전체 가이드 문서.

실행/확인
- docker compose down && docker compose up -d
- docker compose logs -f chatbot
- 예시 질의: “PER 설명해줘”, “삼성전자 최근 뉴스”, “전략 X를 초보자에게 설명”.

자주 겪은 오류와 해결
- Invalid token: IAM에 AmazonBedrockFullAccess 또는 bedrock:InvokeModel 권한 추가.
- 모델 ID 불가: 교차 리전 프로필 ID(us.anthropic.claude-3-5-sonnet-20241022-v2:0) 사용.
- Chroma 임베딩 충돌: SL-ChatBot/rag/vectordb/chroma 폴더 초기화 후 재색인.
- 임베딩 함수 시그니처/식별자: __call__(self, input), name() 구현.
- 환경변수 반영 안 됨: 컨테이너 완전 재생성.

뉴스 질문 예시
- “삼성전자 최근 7일 뉴스 요약하고 투자 관점과 근거를 알려줘.”
- “엔비디아 데이터센터 수요 관련 최신 뉴스 핵심 포인트와 리스크 정리.”

비용/운영
- Bedrock은 호출 시 토큰 단위 과금. 상세는 SL-ChatBot/BEDROCK_SETUP.md 참고.

---
